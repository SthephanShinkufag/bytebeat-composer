let arrays = []
let BPM = 93.825
let baseFreq = 220

let Volume = 30

let kick = (time, startTime) => {
	let t = time - startTime
	let freq = 150 * pow(0.5, t * 10)
	return sin(2 * PI * freq * t) * 1.5
}

let snare = (time, startTime) => {
	let bits = 16000
	let bitT = round(time * bits) / bits
	let t = time - startTime
	let noiset = bitT - startTime
	let freq = 300 * pow(0.5, noiset * 10)
	let tonal = sin(2 * PI * freq * noiset) * 0.5
	let noise = sin(2 * PI * (abs(sin(noiset * 123.456) * 10000) % 1) * noiset) * 1
	return (tonal + noise) * 2
}

let hihat = (time, startTime) => {
	let bits = (random() * 10000)
	let bitT = round(time * bits) / bits
	let t = time - startTime
	let noiset = bitT - startTime
	let freq = 800 * pow(0.01, t * 10)
	let tonal = sin(2 * PI * freq * noiset) * 0.5
	let noise = sin(2 * PI * (abs(sin(noiset * 123.456) * 10000) % 1) * noiset) * 1
	return (tonal + noise) * 1
}

let ophihat = (time, startTime) => {
	let bits = (random() * 25000) + 75000
	let bitT = round(time * bits) / bits
	let t = time - startTime
	let noiset = bitT - startTime
	let freq = 800 * pow(0.01, t * 10)
	let tonal = sin(2 * PI * freq * noiset) * 0.5
	let noise = sin(2 * PI * (abs(sin(noiset * 123.456) * 10000) % 1) * (noiset + 0.05)) * 1.5
	return (tonal + noise) * 1
}

let rhodes = (note, type) => {
	note = note
	let fl = (type / 3) + 0.25
	return (
		sin(note) * (1) +
		sin(note * 2) * (0.6 * fl) +
		sin(note * 3) * (0.3 * fl) +
		sin(note * 4) * (0.2 * fl) +
		sin(note * 5) * (0.1 * fl) +
		sin(note * 6) * (0.05 * fl) +
		sin(note * 7) * (0.05 * fl) +
		sin(note * 8) * (0.02 * fl)
	)
}

let bass = (note, type) => {
	note = note / 8
	let fl = ((type) / 4) + 0.75
	
	let nt = (
		sin(note) +
		sin(note * 2) * (0.5 * fl) +
		sin(note * 3) * (0.2 * fl) +
		sin(note * 4) * (0.1 * fl) +
		sin(note * 5) * (0.05 * fl) +
		sin(note * 6) * (0.02 * fl) +
		sin(note * 7) * (0.01 * fl) +
		sin(note * 8) * (0.005 * fl)
	)

	return (cbrt(nt) / 2) + (nt / 2)
}

let melody = []

let onemelody = [
//first melody
	[[[7, 4, 0, -3], 9], [[1, 0.3, 0.3, 0.3], 1, 1, 0, 1, 0], [2, 2, 2, 1]],
	[[7, 9], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1]],
	[[[9, 4, 0, -3], 9], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[9, 9], [0, 0, 0, 0, 1, 0], [1, 1, 1, 1]],
	[[[12, 4, 0, -3], 19], [[1, 0.3, 0.3, 0.3], 1, 0, 1, 1, 0], [2, 2, 1, 1]],
	[[12, 19], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1]],
	[[[14, 4, 0, -3], 3], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[14, 12], [0, 1, 0, 1, 1, 0], [1, 9, 1, 1]],
	[[[19, 4, 0, -3], 12], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 0, 0], [2, 1, 1, 1]],
	[[19, 12], [0, 0, 0, 0, 0, 1], [2, 2, 1, 1]],
	[[[17, 4, 0, -3], 12], [[1, 0.3, 0.3, 0.3], 0, 1, 0, 0, 0], [2, 1, 1, 1]],
	[[17, 12], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[16, 4, 0, -3], 12], [[1, 0.3, 0.3, 0.3], 0, 0, 1, 1, 0], [2, 1, 1, 1]],
	[[16, 12], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[14, 4, 0, -3], 12], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[14, 12], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[7, 4, 0, -3], 9], [[1, 0.3, 0.3, 0.3], 1, 1, 0, 0, 1], [2, 2, 1, 1]],
	[[7, 9], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1]],
	[[[9, 4, 0, -3], 9], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[9, 9], [0, 0, 0, 0, 1, 0], [1, 1, 1, 1]],
	[[[12, 4, 0, -3], 19], [[1, 0.3, 0.3, 0.3], 1, 0, 1, 1, 0], [2, 2, 1, 1]],
	[[12, 19], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1]],
	[[[14, 4, 0, -3], 3], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[14, 12], [0, 1, 0, 1, 1, 0], [1, 9, 1, 1]],
	[[[19, 4, 0, -3], 12], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 0, 0], [2, 1, 1, 1]],
	[[19, 12], [0, 0, 0, 0, 0, 1], [2, 2, 1, 1]],
	[[[17, 4, 0, -3], 12], [[1, 0.3, 0.3, 0.3], 0, 1, 0, 0, 0], [2, 1, 1, 1]],
	[[17, 12], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[16, 4, 0, -3], 12], [[1, 0.3, 0.3, 0.3], 0, 0, 1, 1, 0], [2, 1, 1, 1]],
	[[16, 12], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[14, 4, 0, -3], 12], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[14, 12], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],

//sec melody
	[[[4, 0, -3, -7], 5], [[0, 0.3, 0.3, 0.3], 1, 1, 0, 1, 0], [2, 2, 1, 1]],
	[[4, 5], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1]],
	[[[7, 0, -3, -7], 5], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[7, 5], [0, 0, 0, 0, 1, 0], [1, 1, 1, 1]],
	[[[9, 0, -3, -7], 12], [[1, 0.3, 0.3, 0.3], 1, 0, 1, 1, 0], [2, 2, 1, 1]],
	[[9, 12], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1]],
	[[[12, 0, -3, -7], 12], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[12, 9], [0, 1, 0, 1, 1, 0], [1, 9, 1, 1]],
	[[[14, 0, -3, -7], 9], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 0, 0], [2, 1, 1, 1]],
	[[14, 9], [0, 0, 0, 0, 0, 1], [2, 2, 1, 1]],
	[[[12, 0, -3, -7], 9], [[1, 0.3, 0.3, 0.3], 0, 1, 0, 0, 0], [2, 1, 1, 1]],
	[[12, 9], [0, 0, 0, 0, 1, 0], [2, 2, 1, 1]],
	[[[9, 0, -3, -7], 9], [[1, 0.3, 0.3, 0.3], 0, 0, 1, 1, 0], [2, 1, 1, 1]],
	[[9, 9], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[7, 0, -3, -7], 9], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[7, 9], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[4, 0, -3, -7], 5], [[1, 0.3, 0.3, 0.3], 1, 1, 0, 0, 1], [2, 2, 1, 1]],
	[[4, 5], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1]],
	[[[7, 0, -3, -7], 5], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[7, 5], [0, 0, 0, 0, 1, 0], [1, 1, 1, 1]],
	[[[9, 0, -3, -7], 12], [[1, 0.3, 0.3, 0.3], 1, 0, 1, 1, 0], [2, 2, 1, 1]],
	[[9, 12], [0, 0, 0, 0, 0, 0], [1, 1, 1, 1]],
	[[[12, 0, -3, -7], 12], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[12, 9], [0, 1, 0, 1, 1, 0], [1, 9, 1, 1]],
	[[[14, 0, -3, -7], 9], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 0, 0], [2, 1, 1, 1]],
	[[14, 9], [0, 0, 0, 0, 1, 0], [2, 2, 1, 1]],
	[[[12, 0, -3, -7], 9], [[1, 0.3, 0.3, 0.3], 0, 1, 0, 0], [2, 1, 1, 1]],
	[[12, 9], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[9, 0, -3, -7], 9], [[1, 0.3, 0.3, 0.3], 0, 0, 1, 1, 0], [2, 1, 1, 1]],
	[[9, 9], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
	[[[7, 0, -3, -7], 9], [[1, 0.3, 0.3, 0.3], 0, 0, 0, 1, 0], [2, 1, 1, 1]],
	[[7, 9], [0, 0, 0, 0, 0, 0], [2, 2, 1, 1]],
]

let twomelody = [
	[[[19, 0, 3, 7],12], [[1, 0.3, 0.3, 0.3],1,1,0,1,0], [8, 8, 1, 1]],
	[[19,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[22,12], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[22,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[17,12], [1,0,0,1,1,0], [2, 1, 1, 1]],
	[[17,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[19,12], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[19,12], [0,0,0,1,0,1], [1, 1, 1, 1]],
	[[[20, 0, 3, 8],8], [[1, 0.3, 0.3, 0.3],1,0,0,0,0], [8, 8, 1, 1]],
	[[20,8], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[19,8], [1,0,1,0,1,0], [2, 1, 1, 1]],
	[[19,8], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[17,8], [1,0,0,1,0,1], [2, 1, 1, 1]],
	[[17,8], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[15,8], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[15,8], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[[11, -1, 3, 5],11], [[1, 0.3, 0.3, 0.3],1,1,0,1,0], [8, 8, 1, 1]],
	[[11,11], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[14,11], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[14,11], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[15,11], [1,0,0,1,1,0], [2, 1, 1, 1]],
	[[15,11], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[17,11], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[17,11], [0,0,0,1,0,1], [1, 1, 1, 1]],
	[[[15, 0, 3, 7],12], [[1, 0.3, 0.3, 0.3],1,0,0,0,0], [8, 8, 1, 1]],
	[[15,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[24,12], [1,0,1,0,1,0], [2, 1, 1, 1]],
	[[24,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[22,12], [1,0,0,1,0,1], [4, 1, 1, 1]],
	[[22,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[22,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[22,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[[19, 0, 3, 7],12], [[1, 0.3, 0.3, 0.3],1,1,0,1,0], [8, 8, 1, 1]],
	[[19,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[22,12], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[22,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[17,12], [1,0,0,1,1,0], [2, 1, 1, 1]],
	[[17,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[19,12], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[19,12], [0,0,0,1,0,1], [1, 1, 1, 1]],
	[[[20, 0, 3, 8],8], [[1, 0.3, 0.3, 0.3],1,0,0,0,0], [8, 8, 1, 1]],
	[[20,8], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[19,8], [1,0,1,0,1,0], [2, 1, 1, 1]],
	[[19,8], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[17,8], [1,0,0,1,0,1], [2, 1, 1, 1]],
	[[17,8], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[15,8], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[15,8], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[[11, -1, 3, 5],11], [[1, 0.3, 0.3, 0.3],1,1,0,1,0], [8, 8, 1, 1]],
	[[11,11], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[14,11], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[14,11], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[15,11], [1,0,0,1,1,0], [2, 1, 1, 1]],
	[[15,11], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[17,11], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[17,11], [0,0,0,1,0,1], [1, 1, 1, 1]],
	[[[24, 0, 3, 7],12], [[1, 0.3, 0.3, 0.3],1,0,0,0,0], [8, 8, 1, 1]],
	[[24,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[24,12], [0,0,1,0,1,0], [2, 1, 1, 1]],
	[[24,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[[27, 22],12], [0.75,0,0,1,0,1], [4, 1, 1, 1]],
	[[27,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[27,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[27,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
]

let threemelody = [
	[[[19, 0, 3, 7],12], [[1, 0.3, 0.3, 0.3],1,1,0,1,0], [8, 8, 1, 1]],
	[[19,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[22,12], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[22,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[19,12], [1,0,0,1,1,0], [2, 1, 1, 1]],
	[[19,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[17,12], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[17,12], [0,0,0,1,0,1], [1, 1, 1, 1]],
	[[[15, 0, 3, 8],8], [[1, 0.3, 0.3, 0.3],1,0,0,0,0], [8, 8, 1, 1]],
	[[15,8], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[14,8], [1,0,1,0,1,0], [2, 1, 1, 1]],
	[[14,8], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[12,8], [1,0,0,1,0,1], [2, 1, 1, 1]],
	[[12,8], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[10,8], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[10,8], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[[11, -1, 3, 5],11], [[1, 0.3, 0.3, 0.3],1,1,0,1,0], [8, 8, 1, 1]],
	[[11,11], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[14,11], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[14,11], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[15,11], [1,0,0,1,1,0], [2, 1, 1, 1]],
	[[15,11], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[17,11], [1,0,0,0,1,0], [2, 1, 1, 1]],
	[[17,11], [0,0,0,1,0,1], [1, 1, 1, 1]],
	[[[24, 0, 3, 7, 19],12], [[0.75, 0.3, 0.3, 0.3, 0.75],1,0,0,0,0], [8, 8, 1, 1]],
	[[[24],12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[24,12], [0,0,1,0,1,0], [2, 1, 1, 1]],
	[[24,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[[27, 22],12], [0.75,0,0,1,0,1], [4, 1, 1, 1]],
	[[27,12], [0,0,0,0,0,0], [1, 1, 1, 1]],
	[[27,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
	[[27,12], [0,0,0,0,1,0], [1, 1, 1, 1]],
]

melody = melody.concat(onemelody)
melody = melody.concat(onemelody)
melody = melody.concat(twomelody)
melody = melody.concat(threemelody)
melody = melody.concat(threemelody)

let lastBeat = -1

return (time, HZ) => {
	time = time
	let s = 0
	let beat = Math.floor(time * BPM / 60 * 4)
	let noteIndex = beat % melody.length

	if (beat != lastBeat) {
		let [notes, amps, lengths] = melody[noteIndex]
		
		let addNote = (note, amp, leng, tm, type) => {
			if (Array.isArray(note)) {
				if (Array.isArray(amp)) {
					if ((Array.isArray(leng))) {
						for (let i = 0; i < note.length; i++) {
							if (!(isNaN(amp[i]) || isNaN(leng[i]))) {
							arrays.push([baseFreq * pow(2, note[n] / 12), amp[i], leng[i], tm, type, random()])
							}
						}
					} else {
						for (let n = 0; n < note.length; n++) {
							if (!(isNaN(amp[n]) || amp[n] == undefined)) {
							arrays.push([baseFreq * pow(2, note[n] / 12), amp[n], leng, tm, type, random()])
							}
						}
					}
				} else {
					if (Array.isArray(leng)) {
						for (let n = 0; n < note.length; n++) {
							if (!(isNaN(amp[n]) || amp[n] == undefined)) {
								arrays.push([baseFreq * pow(2, note[n] / 12), amp, leng[n], tm, type, random()])
							}
						}
					} else {
						for (let n = 0; n < note.length; n++) {
							arrays.push([baseFreq * pow(2, note[n] / 12), amp, leng, tm, type, random()])
						}
					}
				}
			} else {
				arrays.push([baseFreq * pow(2, note / 12), amp, leng, tm, type, random()])
			}
		}

		addNote(notes[0], amps[0], lengths[0] * (15 / BPM), time, "rhodes", random())
		addNote(notes[1], amps[1], lengths[1] * (15 / BPM), time, "bass", random())
		addNote(1, amps[2], 1 * (15 / BPM), time, "kick", random())
		addNote(1, amps[3], 1 * (15 / BPM), time, "snare", random())
		addNote(1, amps[4], 1 * (15 / BPM), time, "hihat", random())
		addNote(1, amps[5], 1 * (15 / BPM), time, "ophihat", random())

		lastBeat = beat
	}

	for (let i = arrays.length - 1; i >= 0; i--) {
		let [freq, amp, lengthSec, startTime, type, notetype] = arrays[i]
   	if (isNaN(freq)) freq = 0
   	if (isNaN(amp)) amp = 0

   	if (type === "rhodes") {
			s += rhodes(time * freq * 2 * PI, notetype) * amp
			arrays[i][1] *= (time > startTime + lengthSec ? 0.995 : 0.99997)
		}
   	else if (type === "bass") {
			s += bass(time * freq * 2 * PI, notetype) * amp
			arrays[i][1] *= (time > startTime + lengthSec ? 0.999 : 0.99999)
		} else if (type === "kick") {
			s += kick(time, startTime) * amp
			arrays[i][1] *= (time > startTime + lengthSec ? 0.9 : 0.9995)
		} else if (type === "snare") {
			s += snare(time, startTime) * amp
			arrays[i][1] *= (time > startTime + lengthSec ? 0.9 : 0.9995)
		} else if (type === "hihat") {
			s += hihat(time, startTime) * amp
			arrays[i][1] *= (time > startTime + lengthSec ? 0.9 : 0.9995)
		} else if (type === "ophihat") {
			s += ophihat(time, startTime) * amp
			arrays[i][1] *= (time > startTime + lengthSec ? 0.9 : 0.9999)
		}

   	if (arrays[i][1] < 0.025) arrays.splice(i, 1)
	}

	if ((time * HZ % 511) == 0) {
		let rhodesArrays = []
		let bassArrays = []
		let kick = false
		let snare = false
		let hihat = false
		let ophat = false
		let bar = (amp) => {
		  let size = 25
		  let fill = Math.min(size, Math.max(0, Math.round(amp * size)))
		  return "█".repeat(fill) + "╳" + "-".repeat(size - fill)
		}
		for (let i = arrays.length - 1; i >= 0; i--) {
			if (arrays[i][4] == "rhodes") {
				let [freq, amp, lengthSec, startTime, type, notetype] = arrays[i]
				if (time < startTime + lengthSec) {
					if (amp > 0) rhodesArrays.push(
						`note=${(12 * Math.log2(freq / baseFreq)).toFixed(0)} len=${lengthSec / (60 / BPM) * 2} [${bar(amp)}]`
					)
				}
			}
			if (arrays[i][4] == "bass") {
				let [freq, amp, lengthSec, startTime, type, notetype] = arrays[i]
				if (time < startTime + lengthSec) {
					if (amp > 0) bassArrays.push(
						`note=${(12 * Math.log2(freq / baseFreq)).toFixed(0)} len=${lengthSec / (60 / BPM) * 2} [${bar(amp)}]`
					)
				}
			}
			if (arrays[i][4] == "kick") {
				let [freq, amp, lengthSec, startTime, type, notetype] = arrays[i]
				if ((time < startTime + lengthSec) && amp > 0) {
					kick ||= true
				}
			}
			if (arrays[i][4] == "snare") {
				let [freq, amp, lengthSec, startTime, type, notetype] = arrays[i]
				if ((time < startTime + lengthSec) && amp > 0) {
					snare ||= true
				}
			}
			if (arrays[i][4] == "hihat") {
				let [freq, amp, lengthSec, startTime, type, notetype] = arrays[i]
				if ((time < startTime + lengthSec) && amp > 0) {
					hihat ||= true
				}
			}
			if (arrays[i][4] == "ophihat") {
				let [freq, amp, lengthSec, startTime, type, notetype] = arrays[i]
				if ((time < startTime + lengthSec) && amp > 0) {
					ophat ||= true
				}
			}
		}

		if (true) {
			throw `\nMaster:\n   Rhodes:\n      ${rhodesArrays.join("\n      ")}\n   Bass:\n      ${bassArrays.join("\n      ")}\n   Kick: ${kick?"O":"|"}\n   Snare: ${snare?"O":"|"}\n   Hihat: ${ophat?"=":hihat?"/":"-"}`
		}
	}

	return s * (Volume / 100)
}

